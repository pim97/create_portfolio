
const height = 50;
const width = 50;
var direction_x = 0;
var direction_y = 0;
var gamespeed = 50;

var snake_coordinates = new Array();

function createMap() {

   var table = document.createElement("TABLE");

   for (var y = 0; y < height; y++) {
       var tr = document.createElement("TR");
       table.appendChild(tr);
       for (var x = 0; x < width; x++) {
            var td = document.createElement("TD");
            td.setAttribute("id", x+"_"+y);

            var text = document.createTextNode(x+"_"+y);

            td.appendChild(text);
            if (x == 0 || y == 0 || x < width && y == (height-1) || y < height && x == (width-1)) {
                // document.write("<td class='wall'>"+x+" "+y+"</td>");
                td.classList.add("wall");
            } else {
                td.classList.add("block");
            }
            tr.appendChild(td);
       }
       document.write("</tr>");
   }
   document.body.appendChild(table);
   document.write("</table>");
}

function mainLoop() {
    moveSnake();
}

function moveSnake() {

    var z = 0;
    // for (var z = 0; z < snake_coordinates.length; z+= 2) {
        //krijgt hierdoor de variable van het element van de coordinaten van de snake
        var snake = document.getElementById(snake_coordinates[z]+"_"+snake_coordinates[z + 1]);
        
        //stopt deze variablen in een 2 tal variabelen voor later gebruik
        var old_x = snake_coordinates[z];
        var old_y = snake_coordinates[z + 1];

        //verwijdert de laatste 2 stukjes van de snake
        snake_coordinates.splice(snake_coordinates.length - 1, old_x);
        snake_coordinates.splice(snake_coordinates.length - 1, old_y);

        //voegt nu weer 2 stukjes toe
        // snake_coordinates.push(old_x, old_y);

        var dir_x = old_x - direction_x;
        var dir_y = old_y - direction_y;

        //en voegt ze weer toe
        snake_coordinates.push(dir_x, dir_y);
        // snake_coordinates.push([4, 4]);

        console.log("dirx: "+direction_x+" diry: "+direction_y+" posx: "+dir_x+" posy: "+dir_y);
        
        if (dir_x == 1 && direction_x == 1) {
            direction_x = -1;
            direction_y = 0;
        } else if (dir_y == 1 && direction_y == 1) {
            direction_x = 0;
            direction_y = -1;
        } else if (dir_y == (height - 2) && direction_y == -1) {
            direction_x = 0;
            direction_y = 1;
        } else if (dir_x == (width - 2) && direction_x == -1) {
            direction_x = 1;
            direction_y = 0;
        }

        //logt de coordinaten van de snake
        // console.log(snake_coordinates.length);

        //block toevoegen -> snake verwijderen
        snake.classList.add("block");
        snake.classList.remove("snake");
        
        //pakt de nieuwe coordinaten van de snake op de coordinaten in de array
        snake = document.getElementById(snake_coordinates[z]+"_"+snake_coordinates[z + 1]);
        
        //block verwijderen -> snake toevoege
        snake.classList.remove("block");
        snake.classList.add("snake");
    // }
}

//zodat je kan luisteren of een key wordt gedrukt of niet
document.addEventListener('keydown', function(event) {
    // console.log(event.keyCode);

    switch (event.keyCode) {
        case 38:
        //moet direction x naar 0 zetten, gaat anders horizontaal
            direction_x = 0;
            direction_y = 1;
        break;

        case 40:
        //moet direction x naar 0 zetten, gaat anders horizontaal
            direction_x = 0;
            direction_y = -1;
        break;

        case 37:
        //moet direction y naar 0 zetten, gaat anders horizontaal
            direction_y = 0;
            direction_x = 1;
        break;

        case 39:
        //moet direction x naar 0 zetten, gaat anders horizontaal
            direction_y = 0;
            direction_x = -1;
        break;
    }
}, false);

function randomValue(value) {
    return Math.floor(Math.random() * value);
}

function start() {
    createMap();

    // snake_coordinates.push(randomValue(width), randomValue(height));
    snake_coordinates.push(2, 1);

    setInterval(mainLoop, gamespeed);
}

start();


